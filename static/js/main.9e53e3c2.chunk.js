(this["webpackJsonpinstagram-clone"]=this["webpackJsonpinstagram-clone"]||[]).push([[0],{10:function(e,t,a){e.exports={post:"Post_post__3eRi_",media:"Post_media__1MKAJ","post-details":"Post_post-details__sRYCO","user-image":"Post_user-image__1j0ao",details:"Post_details__3dKFz","uploader-name":"Post_uploader-name__1chH1","time-posted":"Post_time-posted__3lvXY",actions:"Post_actions__3oRHE","comment-button":"Post_comment-button__1J3B4"}},19:function(e,t,a){e.exports={wrapper:"PostItem_wrapper__2nVTb",media:"PostItem_media__Hz1Wj",details:"PostItem_details__2GpRM"}},26:function(e,t,a){e.exports={"like-button":"LikeButton_like-button__1YtNj"}},35:function(e,t,a){e.exports={posts:"Posts_posts__HBDHm"}},37:function(e,t,a){e.exports=a(54)},42:function(e,t,a){},54:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(33),o=a.n(c),l=(a(42),a(2)),i=a(1),s=a(15);a(43),a(45),a(55);s.initializeApp({apiKey:"AIzaSyAvq_2YPs7aREMZURZ18PHRc5-4xClROLw",authDomain:"instagram-clone-3143a.firebaseapp.com",databaseURL:"https://instagram-clone-3143a.firebaseio.com",projectId:"instagram-clone-3143a",storageBucket:"instagram-clone-3143a.appspot.com",messagingSenderId:"140604303161",appId:"1:140604303161:web:0cb6464b75f0380b096ae8"});var u=s,m=s.auth(),p=s.firestore(),d=s.storage();s.firestore.FieldValue.serverTimestamp;var f=function(){var e=Object(n.useState)(null),t=Object(l.a)(e,2),a=t[0],c=t[1];return m.onAuthStateChanged((function(e){c(e||null)}),(function(e){console.log(e)})),r.a.createElement("div",null,r.a.createElement("h2",null,"Authentication"),a&&r.a.createElement("img",{alt:"User",src:a.photoURL}),a&&r.a.createElement("h3",null,a.displayName," is signed in."),!a&&r.a.createElement("button",{onClick:function(){var e=new u.auth.GoogleAuthProvider;m.signInWithPopup(e).catch((function(e){return console.log(e)}))}},"Sign in with Google"),a&&r.a.createElement("button",{onClick:function(){m.signOut().catch((function(e){return console.log(e)}))}},"Sign out"))},v=a(6),g=a.n(v),E=a(12);var b=function(){var e=Object(n.useState)(null),t=Object(l.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(null),i=Object(l.a)(o,2),s=i[0],u=i[1],f=Object(n.useState)(null),v=Object(l.a)(f,2),b=v[0],h=v[1],j=["image/jpeg","image/png","video/mp4","video/webm","video/ogg"];return r.a.createElement("div",null,r.a.createElement("h2",null,"New Post"),r.a.createElement("form",{onSubmit:function(e){if(e.preventDefault(),a&&j.includes(a.type)){var t=function(e){switch(e){case"image/jpeg":case"image/png":return"images";case"video/mp4":case"video/webm":case"video/ogg":return"videos"}}(a.type),n=d.ref(t+"/"+a.name),r=p.collection("posts"),c=n.put(a);c.on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes*100;console.log("Upload is "+t+"% done")}),(function(e){console.log(e)}),Object(E.a)(g.a.mark((function e(){var t,n,o,l,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Date,n=m.currentUser,o=n.uid,l=n.displayName,i=n.photoURL,e.next=4,c.snapshot.ref.getDownloadURL().then((function(e){r.add({url:e,caption:s,createdAt:t,uid:o,user:l,userImage:i,type:a.type,comments:[],likedBy:[]})}));case 4:case"end":return e.stop()}}),e)}))))}},autoComplete:"off"},r.a.createElement("label",{htmlFor:"file"},"Choose an image"),r.a.createElement("input",{onChange:function(e){j.includes(e.target.files[0].type)?(h(null),c(e.target.files[0])):h("Invalid file: Please select an image (jpeg/png) or a video (mp4/webm/ogg).")},type:"file",id:"file"}),r.a.createElement("label",{htmlFor:"caption"},"Write a caption"),r.a.createElement("input",{onChange:function(e){u(e.target.value)},type:"text",id:"caption"}),r.a.createElement("input",{type:"submit",value:"Share",disabled:b})),b&&r.a.createElement("h3",null,b))},h=a(29),j=function(e){var t=Object(n.useState)([]),a=Object(l.a)(t,2),r=a[0],c=a[1];return Object(n.useEffect)((function(){var t=p.collection(e).orderBy("createdAt","desc").onSnapshot((function(e){var t=[];e.forEach((function(e){t.push(Object(h.a)(Object(h.a)({},e.data()),{},{id:e.id}))})),c(t)}));return function(){return t()}}),[e]),{posts:r}};var _=a(23),y=a(26),O=a.n(y);var w=function(e){var t=e.id,a=e.likedBy,c={};m.currentUser&&(c=m.currentUser);var o=c,i=o.uid,s=o.displayName,u=o.photoURL,d=p.collection("posts").doc(t),f=Object(n.useState)(!1),v=Object(l.a)(f,2),b=v[0],h=v[1];Object(n.useEffect)((function(){a.filter((function(e){return e.uid===i})).length>0?h(!0):h(!1)}));var j=function(){var e=Object(E.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(Object(_.a)(a),[{uid:i,user:s,userImage:u,createdAt:new Date}]),e.next=3,d.update({likedBy:t});case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=Object(E.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.filter((function(e){return e.uid!==i})),e.next=3,d.update({likedBy:t});case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",null,b&&r.a.createElement("button",{className:O.a["like-button"],onClick:y},"Remove Like"),!b&&r.a.createElement("button",{className:O.a["like-button"],onClick:j},"Like"))};var k=function(e){var t=e.id,a=Object(n.useState)(null),c=Object(l.a)(a,2),o=c[0],i=c[1],s=p.collection("posts").doc(t);if(m.currentUser){var u=m.currentUser,d=u.uid,f=u.displayName,v=u.photoURL,b=function(){var e=Object(E.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.get().then(function(){var e=Object(E.a)(g.a.mark((function e(t){var a,n,r,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new Date,n=t.data().comments,r={comment:o,uid:d,user:f,userImage:v,createdAt:a},c={},c=n?[].concat(Object(_.a)(n),[r]):[r],e.next=7,s.update({comments:c});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log(e)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement("img",{alt:f,src:v}),r.a.createElement("input",{onChange:function(e){i(e.target.value)},type:"text",placeholder:"Add a comment..."}),r.a.createElement("button",{onClick:b},"Post"))}return r.a.createElement("div",null)},N=a(10),P=a.n(N),S=a(56),x=a(57),A=a(16);function C(e){var t=e.caption,a=e.url;return r.a.createElement("img",{className:P.a.media,alt:t,src:a})}function I(e){var t=e.url,a=e.type;return r.a.createElement("video",{className:P.a.media,autoPlay:!0,loop:!0},r.a.createElement("source",{src:t,type:a}))}function B(e){var t=e.post,a=t.caption,n=t.createdAt,c=t.id,o=t.url,l=t.user,i=t.userImage,s=t.type,u=(t.comments,t.likedBy),m=Object(S.a)(Object(x.a)(n.seconds),new Date);return r.a.createElement("div",{className:P.a.post},/image/g.test(s)&&r.a.createElement(C,{caption:a,url:o}),/video/g.test(s)&&r.a.createElement(I,{url:o,type:s}),r.a.createElement("div",{className:P.a["post-details"]},r.a.createElement("img",{className:P.a["user-image"],alt:l,src:i}),r.a.createElement("div",{className:P.a.details},r.a.createElement("p",{className:P.a["uploader-name"]},l),r.a.createElement("p",{className:P.a["time-posted"]},m," ago")),r.a.createElement("div",{className:P.a.actions},r.a.createElement(w,{className:P.a["like-button"],id:c,likedBy:u}),r.a.createElement("div",null,r.a.createElement(A.b,{to:"/posts/".concat(c)},r.a.createElement("button",{onClick:function(){},className:P.a["comment-button"]},"Comment"))))))}var R=a(35),U=a.n(R);var L=function(){var e=j("posts").posts;return r.a.createElement("div",{className:U.a.posts},e&&e.map((function(e){return r.a.createElement(B,{key:e.id,post:e})})))};var D=function(){return r.a.createElement("div",null,r.a.createElement(b,null),r.a.createElement(L,null))},H=function(e){var t=Object(n.useState)([]),a=Object(l.a)(t,2),r=a[0],c=a[1],o=Object(n.useState)(null),i=Object(l.a)(o,2),s=i[0],u=i[1];return Object(n.useEffect)((function(){var t=p.collection("posts").doc(e).onSnapshot((function(e){var t=e.data();t&&(t.createdAt=Object(S.a)(Object(x.a)(t.createdAt.seconds),new Date),c(t))}),(function(e){u(e)}));return function(){return t()}}),[e]),{post:r,error:s}},W=a(19),z=a.n(W);function F(e){var t=e.caption,a=e.url;return r.a.createElement("img",{className:z.a.media,alt:t,src:a})}function J(e){var t=e.url,a=e.type;return r.a.createElement("video",{className:z.a.media,autoPlay:!0,loop:!0},r.a.createElement("source",{src:t,type:a}))}var M=function(){var e=Object(i.f)().id,t=H(e).post;if(t&&0!==Object.keys(t).length){var a=t.caption,n=t.createdAt,c=t.url,o=t.user,l=(t.userImage,t.type),s=t.comments;t.likedBy;return r.a.createElement("div",{className:z.a.wrapper},r.a.createElement("div",null,/image/g.test(l)&&r.a.createElement(F,{caption:a,url:c}),/video/g.test(l)&&r.a.createElement(J,{url:c,type:l})),r.a.createElement("div",{className:z.a.details},r.a.createElement("p",null,o),r.a.createElement("p",null,a),s&&s.map((function(e){return r.a.createElement("div",{key:s.indexOf(e)},r.a.createElement("img",{alt:e.user,src:e.userImage}),r.a.createElement("p",null,e.comment))})),r.a.createElement(k,{id:e}),n&&r.a.createElement("p",null,n," ago")))}return r.a.createElement("div",null,r.a.createElement("h1",null,"Post not found."))};var Y=function(){var e=Object(n.useState)(!1),t=Object(l.a)(e,2),a=t[0],c=t[1];return m.onAuthStateChanged((function(e){c(!!e)}),(function(e){console.log(e)})),r.a.createElement("div",null,r.a.createElement(f,null),r.a.createElement(i.c,null,r.a.createElement(i.a,{exact:!0,path:"/"},a&&r.a.createElement(D,null)),r.a.createElement(i.a,{path:"/posts/:id",children:r.a.createElement(M,null)}),r.a.createElement(i.a,{path:"*"},r.a.createElement("h1",null,"404: Page not found"))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(A.a,null,r.a.createElement(Y,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[37,1,2]]]);
//# sourceMappingURL=main.9e53e3c2.chunk.js.map