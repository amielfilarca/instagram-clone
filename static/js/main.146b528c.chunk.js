(this["webpackJsonpinstagram-clone"]=this["webpackJsonpinstagram-clone"]||[]).push([[0],{20:function(e,t,a){e.exports={"like-button":"LikeButton_like-button__1YtNj",icon:"LikeButton_icon__3-Hmh"}},21:function(e,t,a){e.exports={wrapper:"PostItem_wrapper__2nVTb",media:"PostItem_media__Hz1Wj",details:"PostItem_details__2GpRM"}},34:function(e,t,a){e.exports=a.p+"static/media/like-filled.e39a07e6.svg"},35:function(e,t,a){e.exports=a.p+"static/media/like.2da23ddc.svg"},36:function(e,t,a){e.exports=a.p+"static/media/comment.2bf9666a.svg"},39:function(e,t,a){e.exports={posts:"Posts_posts__HBDHm"}},41:function(e,t,a){e.exports=a(59)},46:function(e,t,a){},59:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(33),o=a.n(c),i=(a(46),a(2)),l=a(1),s=a(15);a(47),a(49),a(60);s.initializeApp({apiKey:"AIzaSyAvq_2YPs7aREMZURZ18PHRc5-4xClROLw",authDomain:"instagram-clone-3143a.firebaseapp.com",databaseURL:"https://instagram-clone-3143a.firebaseio.com",projectId:"instagram-clone-3143a",storageBucket:"instagram-clone-3143a.appspot.com",messagingSenderId:"140604303161",appId:"1:140604303161:web:0cb6464b75f0380b096ae8"});var u=s,m=s.auth(),p=s.firestore(),d=s.storage();s.firestore.FieldValue.serverTimestamp;var f=function(){var e=Object(n.useState)(null),t=Object(i.a)(e,2),a=t[0],c=t[1];return m.onAuthStateChanged((function(e){c(e||null)}),(function(e){console.log(e)})),r.a.createElement("div",null,r.a.createElement("h2",null,"Authentication"),a&&r.a.createElement("img",{alt:"User",src:a.photoURL}),a&&r.a.createElement("h3",null,a.displayName," is signed in."),!a&&r.a.createElement("button",{onClick:function(){var e=new u.auth.GoogleAuthProvider;m.signInWithPopup(e).catch((function(e){return console.log(e)}))}},"Sign in with Google"),a&&r.a.createElement("button",{onClick:function(){m.signOut().catch((function(e){return console.log(e)}))}},"Sign out"))},v=a(6),g=a.n(v),E=a(12);var h=function(){var e=Object(n.useState)(null),t=Object(i.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(null),l=Object(i.a)(o,2),s=l[0],u=l[1],f=Object(n.useState)(null),v=Object(i.a)(f,2),h=v[0],b=v[1],j=["image/jpeg","image/png","video/mp4","video/webm","video/ogg"];return r.a.createElement("div",null,r.a.createElement("h2",null,"New Post"),r.a.createElement("form",{onSubmit:function(e){if(e.preventDefault(),a&&j.includes(a.type)){var t=function(e){switch(e){case"image/jpeg":case"image/png":return"images";case"video/mp4":case"video/webm":case"video/ogg":return"videos"}}(a.type),n=d.ref(t+"/"+a.name),r=p.collection("posts"),c=n.put(a);c.on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes*100;console.log("Upload is "+t+"% done")}),(function(e){console.log(e)}),Object(E.a)(g.a.mark((function e(){var t,n,o,i,l;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Date,n=m.currentUser,o=n.uid,i=n.displayName,l=n.photoURL,e.next=4,c.snapshot.ref.getDownloadURL().then((function(e){r.add({url:e,caption:s,createdAt:t,uid:o,user:i,userImage:l,type:a.type,comments:[],likedBy:[]})}));case 4:case"end":return e.stop()}}),e)}))))}},autoComplete:"off"},r.a.createElement("label",{htmlFor:"file"},"Choose an image"),r.a.createElement("input",{onChange:function(e){j.includes(e.target.files[0].type)?(b(null),c(e.target.files[0])):b("Invalid file: Please select an image (jpeg/png) or a video (mp4/webm/ogg).")},type:"file",id:"file"}),r.a.createElement("label",{htmlFor:"caption"},"Write a caption"),r.a.createElement("input",{onChange:function(e){u(e.target.value)},type:"text",id:"caption"}),r.a.createElement("input",{type:"submit",value:"Share",disabled:h})),h&&r.a.createElement("h3",null,h))},b=a(17),j=function(e){var t=Object(n.useState)([]),a=Object(i.a)(t,2),r=a[0],c=a[1];return Object(n.useEffect)((function(){var t=p.collection(e).orderBy("createdAt","desc").onSnapshot((function(e){var t=[];e.forEach((function(e){t.push(Object(b.a)(Object(b.a)({},e.data()),{},{id:e.id}))})),c(t)}));return function(){return t()}}),[e]),{posts:r}};var _=a(25),O=a(20),y=a.n(O),k=a(34),w=a.n(k),N=a(35),P=a.n(N);var x=function(e){var t=e.id,a=e.likedBy,c={};m.currentUser&&(c=m.currentUser);var o=c,l=o.uid,s=o.displayName,u=o.photoURL,d=p.collection("posts").doc(t),f=Object(n.useState)(!1),v=Object(i.a)(f,2),h=v[0],b=v[1];Object(n.useEffect)((function(){a.filter((function(e){return e.uid===l})).length>0?b(!0):b(!1)}));var j=function(){var e=Object(E.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(Object(_.a)(a),[{uid:l,user:s,userImage:u,createdAt:new Date}]),e.next=3,d.update({likedBy:t});case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(){var e=Object(E.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.filter((function(e){return e.uid!==l})),e.next=3,d.update({likedBy:t});case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",null,h&&r.a.createElement("button",{className:y.a["like-button"],onClick:O},r.a.createElement("img",{className:y.a.icon,alt:"Like",src:w.a})),!h&&r.a.createElement("button",{className:y.a["like-button"],onClick:j},r.a.createElement("img",{className:y.a.icon,alt:"Like",src:P.a})))};var S=function(e){var t=e.id,a=Object(n.useState)(null),c=Object(i.a)(a,2),o=c[0],l=c[1],s=p.collection("posts").doc(t);if(m.currentUser){var u=m.currentUser,d=u.uid,f=u.displayName,v=u.photoURL,h=function(){var e=Object(E.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.get().then(function(){var e=Object(E.a)(g.a.mark((function e(t){var a,n,r,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new Date,n=t.data().comments,r={comment:o,uid:d,user:f,userImage:v,createdAt:a},c={},c=n?[].concat(Object(_.a)(n),[r]):[r],e.next=7,s.update({comments:c});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log(e)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement("img",{alt:f,src:v}),r.a.createElement("input",{onChange:function(e){l(e.target.value)},type:"text",placeholder:"Add a comment..."}),r.a.createElement("button",{onClick:h},"Post"))}return r.a.createElement("div",null)},A=a(9),B=a.n(A),C=a(61),I=a(62),R=a(36),U=a.n(R),L=a(37),D=a.n(L);var H=function(){var e=Object(l.h)(),t=Object(l.g)(),a=Object(l.f)(),r=Object(l.i)();return Object(n.useMemo)((function(){return{push:a.push,replace:a.replace,pathname:t.pathname,query:Object(b.a)(Object(b.a)({},D.a.parse(t.search)),e),match:r,location:t,history:a}}),[e,r,t,a])};function M(e){var t=e.caption,a=e.url;return r.a.createElement("img",{className:B.a.media,alt:t,src:a})}function W(e){var t=e.url,a=e.type;return r.a.createElement("video",{className:B.a.media,autoPlay:!0,loop:!0},r.a.createElement("source",{src:t,type:a}))}function z(e){var t=e.post,a=t.caption,n=t.createdAt,c=t.id,o=t.url,i=t.user,l=t.userImage,s=t.type,u=(t.comments,t.likedBy),m=H(),p=Object(C.a)(Object(I.a)(n.seconds),new Date);return r.a.createElement("div",{className:B.a.post},/image/g.test(s)&&r.a.createElement(M,{caption:a,url:o}),/video/g.test(s)&&r.a.createElement(W,{url:o,type:s}),r.a.createElement("div",{className:B.a["post-details"]},r.a.createElement("img",{className:B.a["user-image"],alt:i,src:l}),r.a.createElement("div",{className:B.a.details},r.a.createElement("p",{className:B.a["uploader-name"]},i),r.a.createElement("p",{className:B.a["time-posted"]},p," ago")),r.a.createElement("div",{className:B.a.actions},r.a.createElement(x,{className:B.a["like-button"],id:c,likedBy:u}),r.a.createElement("div",null,r.a.createElement("button",{className:B.a["comment-button"],onClick:function(e){return m.push("/posts/".concat(c))}},r.a.createElement("img",{className:B.a.icon,alt:"Comment",src:U.a}))))))}var F=a(39),J=a.n(F);var Y=function(){var e=j("posts").posts;return r.a.createElement("div",{className:J.a.posts},e&&e.map((function(e){return r.a.createElement(z,{key:e.id,post:e})})))};var G=function(){return r.a.createElement("div",null,r.a.createElement(h,null),r.a.createElement(Y,null))},K=function(e){var t=Object(n.useState)([]),a=Object(i.a)(t,2),r=a[0],c=a[1],o=Object(n.useState)(null),l=Object(i.a)(o,2),s=l[0],u=l[1];return Object(n.useEffect)((function(){var t=p.collection("posts").doc(e).onSnapshot((function(e){var t=e.data();t&&(t.createdAt=Object(C.a)(Object(I.a)(t.createdAt.seconds),new Date),c(t))}),(function(e){u(e)}));return function(){return t()}}),[e]),{post:r,error:s}},T=a(21),q=a.n(T);function V(e){var t=e.caption,a=e.url;return r.a.createElement("img",{className:q.a.media,alt:t,src:a})}function Z(e){var t=e.url,a=e.type;return r.a.createElement("video",{className:q.a.media,autoPlay:!0,loop:!0},r.a.createElement("source",{src:t,type:a}))}var X=function(){var e=Object(l.h)().id,t=K(e).post;if(t&&0!==Object.keys(t).length){var a=t.caption,n=t.createdAt,c=t.url,o=t.user,i=(t.userImage,t.type),s=t.comments;t.likedBy;return r.a.createElement("div",{className:q.a.wrapper},r.a.createElement("div",null,/image/g.test(i)&&r.a.createElement(V,{caption:a,url:c}),/video/g.test(i)&&r.a.createElement(Z,{url:c,type:i})),r.a.createElement("div",{className:q.a.details},r.a.createElement("p",null,o),r.a.createElement("p",null,a),s&&s.map((function(e){return r.a.createElement("div",{key:s.indexOf(e)},r.a.createElement("img",{alt:e.user,src:e.userImage}),r.a.createElement("p",null,e.comment))})),r.a.createElement(S,{id:e}),n&&r.a.createElement("p",null,n," ago")))}return r.a.createElement("div",null,r.a.createElement("h1",null,"Post not found."))};var $=function(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),a=t[0],c=t[1];return m.onAuthStateChanged((function(e){c(!!e)}),(function(e){console.log(e)})),r.a.createElement("div",null,r.a.createElement(f,null),r.a.createElement(l.c,null,r.a.createElement(l.a,{exact:!0,path:"/"},a&&r.a.createElement(G,null)),r.a.createElement(l.a,{path:"/posts/:id",children:r.a.createElement(X,null)}),r.a.createElement(l.a,{path:"*"},r.a.createElement("h1",null,"404: Page not found"))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Q=a(16);o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Q.a,null,r.a.createElement($,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},9:function(e,t,a){e.exports={post:"Post_post__3eRi_",media:"Post_media__1MKAJ","post-details":"Post_post-details__sRYCO","user-image":"Post_user-image__1j0ao",details:"Post_details__3dKFz","uploader-name":"Post_uploader-name__1chH1","time-posted":"Post_time-posted__3lvXY",actions:"Post_actions__3oRHE","comment-button":"Post_comment-button__1J3B4",icon:"Post_icon__28Dh6"}}},[[41,1,2]]]);
//# sourceMappingURL=main.146b528c.chunk.js.map